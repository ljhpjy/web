!function(){"use strict";var e,n,t,r,i,u,o={5745:function(e,n,t){function r(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}t.d(n,{Z:function(){return r}}),t(28572)},15969:function(e,n,t){t.d(n,{Z:function(){return s}});var r=t(82982),i=t(85515),u=t(9191),o=t(5745);function s(e){return(0,r.Z)(e)||(0,i.Z)(e)||(0,u.Z)(e)||(0,o.Z)()}},33799:function(e,n,t){t.d(n,{Z:function(){return i}});var r=t(33654);function i(e,n,t){var i=r.useRef({});return(!("value"in i.current)||t(i.current.condition,n))&&(i.current.value=e(),i.current.condition=n),i.current.value}},23080:function(e,n,t){e.exports=t(38313)},7973:function(e,n,t){t.d(n,{hY:function(){return i.Z},dh:function(){return u.Z},Ee:function(){return o.C},sZ:function(){return r.Z}});var r=t(33153),i=t(81333),u=t(27160),o=t(7483);t(7535),t(33654),t(38415),t(48069)},38415:function(e,n,t){t.d(n,{Z:function(){return u}}),t(97127),t(28213),t(58032);var r=t(7535),i=(0,t(53528).Z)({scriptUrl:Promise.resolve().then(t.t.bind(t,5656,23))});function u(e){var n=e.type,t=e.className,u=e.style,o=e.onClick;return(0,r.jsx)(i,{type:n,className:t,style:u,onClick:o})}},465:function(e,n,t){t.d(n,{$5:function(){return r},_n:function(){return i},xS:function(){return u}});var r="COOKIE_DEVICE_ID",i={test:"https://ai-api-test.dangbei.net/ai-search",pre:"https://ai-api.dangbei.net/ai-search",online:"https://ai-api.dangbei.net/ai-search",dev:"https://ai-api-test.dangbei.net/ai-search"},u={model:"deepseek",modelList:[{icon:"https://ai-search-static.dangbei.net/2025/03/21/1902984234851766272.png",title:"DeepSeek-R1",value:"deepseek",option:[{disable:!1,title:"深度思考",value:"deep",selected:!1},{disable:!1,title:"联网搜索",value:"online",selected:!1}]}]}},72137:function(e,n,t){t.d(n,{$N:function(){return x},B9:function(){return m},DI:function(){return c},O_:function(){return d},Pv:function(){return b},Uj:function(){return p},YQ:function(){return g},f6:function(){return I},lA:function(){return y},ou:function(){return h},pc:function(){return f},xI:function(){return v}});var r=t(49674),i=t(53490),u=t(51897);t(9579),t(28213),t(58032);var o=t(33654),s=t(40921),a=t(46978);function l(e,n){var t=(0,o.useRef)(n);t.current=n,(0,o.useEffect)(function(){var n=function(e){return t.current(e)};return s.uY.on(e,n),function(){s.uY.off(e,n)}},[e])}function c(e){l("loginChange",(0,r._)(function(){return(0,u.Jh)(this,function(n){return[2,e()]})}))}function d(){var e=(0,i._)((0,o.useState)(),2),n=e[0],t=e[1],l=(0,i._)((0,o.useState)(!0),2),c=l[0],d=l[1],f=(0,o.useCallback)(function(){var e;d(!0),(0,a.Z)((e=(0,r._)(function(e){var n;return(0,u.Jh)(this,function(r){switch(r.label){case 0:return[4,(0,s.Wd)(!0)];case 1:return(n=r.sent())&&(t(n),e()),[2]}})}),function(n){return e.apply(this,arguments)}),{maxAttempts:30,interval:100}).finally(function(){d(!1)})},[]);return(0,o.useEffect)(function(){f()},[f]),{data:n,loading:c}}function f(e){l("requestUnFocus",e)}function p(e){l("clearAgentContext",e)}function v(e){l("keyboardOpen",e)}function m(e){l("keyboardClose",e)}function h(e){l("appStatus",function(n){"resumed"===n.state&&e()})}function g(e){l("closeDialog",(0,r._)(function(){return(0,u.Jh)(this,function(n){return[2,e()]})}))}function b(e){var n;l("onFlutterDialogChange",(n=(0,r._)(function(n){return(0,u.Jh)(this,function(t){return[2,e(n)]})}),function(e){return n.apply(this,arguments)}))}function x(e){var n;l("notifyAddFilesStatus",(n=(0,r._)(function(n){return(0,u.Jh)(this,function(t){return[2,e(n)]})}),function(e){return n.apply(this,arguments)}))}function y(e){var n;l("notifyAsrResult",(n=(0,r._)(function(n){return(0,u.Jh)(this,function(t){return[2,e(n)]})}),function(e){return n.apply(this,arguments)}))}function I(e){var n=e.defaultState,t=e.key,r=(0,i._)((0,o.useState)(),2),u=r[0],a=r[1];(0,o.useEffect)(function(){u&&s.ZP.setStorage(t,{value:u})},[u]);var l=function(){s.ZP.getStorage(t).then(function(e){var t;a(null!=(t=null==e?void 0:e.value)?t:n)})};return(0,o.useLayoutEffect)(l,[]),h(l),[u,a]}},35770:function(e,n,t){t.d(n,{$d:function(){return s.$},DM:function(){return i.D},P2:function(){return a.P},TA:function(){return c.T},VP:function(){return r.V},Yv:function(){return o.Y},dz:function(){return l.d},lq:function(){return p.l},nO:function(){return u.n},yG:function(){return d.y},zp:function(){return f.z}}),t(48227);var r=t(4673),i=t(53402),u=t(10400),o=t(53819),s=t(677),a=t(29354),l=t(26613),c=t(44090),d=t(73618);t(7357);var f=t(13735),p=t(60578);t(89864),t(59070)},10400:function(e,n,t){t.d(n,{n:function(){return g}});var r=t(49674),i=t(779),u=t(82616),o=t(53490),s=t(55526),a=t(51897);t(684),t(70986),t(34088),t(18677),t(51016),t(26601),t(9426),t(93355),t(33262),t(48435),t(91216),t(26409),t(31740),t(62687),t(29957),t(24679),t(46575),t(81273),t(58032),t(81144),t(16825),t(81164),t(28572),t(60833),t(14438),t(46395),t(18566),t(60515),t(19553);var l=t(33654),c=t(72407),d=t(55827),f=t(14333),p=t(49932),v=t(48069),m=t(35770),h=t(21730),g=function(e,n){var t,g=(0,o._)((0,l.useState)(!1),2),b=g[0],x=g[1],y=(0,l.useRef)(new Map),I=(0,m.dz)(n),_=(0,l.useRef)(function(){}),C=(0,l.useCallback)((t=(0,r._)(function(n,t){var r,u,o,s,l,d,f,m,g,b,C,j,w,P,S,N,M,T,Z,k,E,A,L,R,O,D,U,q,F,B,J,H,Y,z,V,$,K;return(0,a.Jh)(this,function(a){switch(a.label){case 0:r=n.message,u=t.onSuccess,o=t.onUpdate,t.onError,l=null!=(s=null==r?void 0:r.content)?s:{},d=(0,h.x0)(6),f=!1,m={role:"suggestion",pid:null==r?void 0:r.uuid,uuid:(0,h.x0)(6),content:[]},b={role:"ai",uuid:d,content:[g={role:"ai",pid:null==r?void 0:r.uuid,uuid:(0,h.x0)(6),status:"loading",question:l.question,content:""}]},C=function(){var e;f&&(m.status="success"),(null==(e=m.content)?void 0:e.length)||2!=b.content.length||b.content.splice(1,1),g.status="success",u(b)},a.label=1;case 1:if(a.trys.push([1,8,,9]),x(!0),j=I(),w=new AbortController,_.current=function(){w.abort()},P=(0,i._)({},e,l),!(null==j?void 0:j.beforeSubmit))return[3,3];return[4,j.beforeSubmit(P)];case 2:(S=a.sent())&&Object.assign(P,S),a.label=3;case 3:return[4,(0,p.mz)({body:P,parseAs:"stream",signal:w.signal})];case 4:if(M=(N=a.sent()).response,T=N.error,200!==M.status)throw Error(null==T?void 0:T.errMessage);Z=(0,c.Z)({readableStream:M.body}).getReader(),_.current=function(){w.abort(),g.content||(g.content="本次回答已被中止",g.isMessageEmpty=!0),null==Z||Z.cancel()},k=function(e,n){g.msgId=e,(null==r?void 0:r.uuid)&&y.current.set(null==r?void 0:r.uuid,n)},E=function(e){g.content+=e,"loading"===g.status&&(g.status="updating")},A=function(e){g.content+=e,"loading"===g.status&&(g.status="updating")},L=function(e,n){if(g.status="success","follow_up"===e){var t;null==(t=m.content)||t.push(n),f||(f=!0,b.content.push(m))}},a.label=5;case 5:if(!Z)return[3,7];return[4,Z.read()];case 6:O=(R=a.sent()).value,D=R.done;try{if(q=(U=null!=O?O:{}).data,F=U.event,J=(B=(0,v.Vx)(q)?JSON.parse(q):{}).type,H=B.content,Y=B.content_type,D)return null==j||null==(z=j.onChatCompleted)||z.call(j,P.conversationId),C(),[3,7];switch(F){case"conversation.message.delta":g.msgId||k(B.id,B.parentMsgId),"answer"===J&&"text"===Y&&E(H);break;case"conversation.followup.loading":m.status="loading",b.content.push(m);break;case"conversation.chat.failed":"answer"===J&&"text"===Y&&A(H);break;case"conversation.message.completed":L(J,H);break;case"conversation.chat.completed":null==j||null==(V=j.onChatCompleted)||V.call(j,P.conversationId)}o(b)}catch(e){throw Error(e)}return[3,5];case 7:return x(!1),[3,9];case 8:if($=a.sent(),x(!1),K=$,g.content||(g.isMessageEmpty=!0),"AbortError"===K.name)return g.content="本次回答已被中止",C(),[2];if("TypeError"===K.name&&"Failed to fetch"===K.message)return g.status="success",(null==g?void 0:g.content)||(g.content=navigator.onLine?"服务器繁忙，请稍后再试！":"当前你的网络不稳定"),C(),[2];throw"Error"===K.name&&(g.content=K.message,g.status="success",C()),K;case 9:return[2]}})}),function(e,n){return t.apply(this,arguments)}),[]),j=(0,o._)((0,d.Z)({request:C}),1)[0],w=(0,f.Z)({agent:j,requestPlaceholder:{role:"ai",content:"Waiting...",status:"loading"},requestFallback:function(e,n){return n.error,{role:"error",content:"服务器繁忙，请稍后再试！"}},parser:function(e){return((Array.isArray(e.content)?e.content:[e])||[]).map(function(e){return(0,u._)((0,i._)({},e),{content:e.content})})}}),P=w.onRequest,S=w.messages,N=w.parsedMessages,M=w.setMessages,T=(0,l.useDeferredValue)(N),Z=(0,l.useCallback)(function(e){var n=S.findIndex(function(n){return(Array.isArray(n.message.content)?n.message.content[0]:n.message).uuid===e});-1!==n&&M(function(e){return e.splice(n,1),(0,s._)(e)})},[S]),k=(0,m.DM)(Z);return{loading:b,messages:S,parsedMessages:T,setMessages:M,questionIdsMap:y,onChatSubmit:(0,m.DM)(function(e){P(e)}),onRemoveChatHistory:k,onCancelReply:function(){return _.current()}}}},60578:function(e,n,t){t.d(n,{l:function(){return p}});var r=t(49674),i=t(779),u=t(53490),o=t(51897);t(16825),t(28572);var s=t(7535),a=t(33654),l=t(40921),c=t(73618),d=t(48821),f=t(49932),p=function(){var e,n,t=(0,u._)((0,a.useState)(!1),2),p=t[0],v=t[1],m=(0,u._)((0,a.useState)(),2),h=m[0],g=m[1],b=(0,a.useRef)(function(){}),x=(0,c.y)(l.ZP.getWsId);return{switchSpeech:(e=(0,r._)(function(e){var n;return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,l.ZP.getTtsPlayStatus()];case 1:var u;if((null==(n=t.sent())?void 0:n.isPlaying)&&(null==n?void 0:n.msgId)===e.msgId)return l.ZP.onInterruptTts(),g(void 0),[2];return b.current(),u=(0,r._)(function(){var n,t;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),v(!0),g(e.msgId),n=new AbortController,l.ZP.onInterruptTts(),b.current=function(){x.stopPolling(),n.abort()},[4,x.startPolling()];case 1:if(!(t=r.sent()))throw Error("wsId is null");return[4,(0,f.Sd)({body:(0,i._)({wsId:t},e),signal:n.signal})];case 2:return r.sent().data.success,v(!1),[2,!0];case 3:return r.sent(),v(!1),[2,!1];case 4:return[2]}})}),[4,function(){return u.apply(this,arguments)}()];case 2:return t.sent()||d.ZP.error((0,s.jsx)("span",{className:"text-14",children:"语音播报生成失败！"})),[2]}})}),function(n){return e.apply(this,arguments)}),stopSpeech:(n=(0,r._)(function(){var e;return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,l.ZP.getTtsPlayStatus()];case 1:return(null==(e=n.sent())?void 0:e.isPlaying)&&l.ZP.onInterruptTts(),[2]}})}),function(){return n.apply(this,arguments)}),speechMessageId:h,speechLoading:p}}},53819:function(e,n,t){t.d(n,{Y:function(){return u}});var r=t(53490),i=t(33654),u=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vertical",t=(0,r._)((0,i.useState)({direction:null,distance:0}),2),u=t[0],o=t[1],s=(0,i.useRef)(0),a=(0,i.useRef)(0),l=(0,i.useRef)(!1),c=(0,i.useRef)(),d=(0,i.useRef)(u),f=function(e){s.current=e.clientX,a.current=e.clientY,l.current=!0},p=function(e){l.current&&(c.current&&cancelAnimationFrame(c.current),c.current=requestAnimationFrame(function(){var t,r=e.clientX,i=e.clientY,u=r-s.current,l=i-a.current;5>Math.abs(u)&&5>Math.abs(l)||((t="horizontal"===n?{direction:u>0?"right":"left",distance:Math.abs(u)}:{direction:l>0?"down":"up",distance:Math.abs(l)}).direction!==d.current.direction||t.distance!==d.current.distance)&&(d.current=t,o(t))}))},v=function(){l.current=!1,o({direction:null,distance:0})};return(0,i.useEffect)(function(){var n="function"==typeof e?e():e&&"current"in e?e.current:e;if(n){var t={passive:!0};return n.addEventListener("pointerdown",f,t),n.addEventListener("pointermove",p,t),n.addEventListener("pointerup",v,t),n.addEventListener("pointercancel",v,t),function(){n.removeEventListener("pointerdown",f),n.removeEventListener("pointermove",p),n.removeEventListener("pointerup",v),n.removeEventListener("pointercancel",v)}}},[e]),(0,i.useEffect)(function(){return function(){c.current&&cancelAnimationFrame(c.current)}},[]),u}},27343:function(e,n,t){var r=t(7535),i=t(33654),u=t(70332),o=t(3092),s=t(49674),a=t(779),l=t(82616),c=t(53490),d=t(55526),f=t(51897);t(46395),t(18566),t(60515),t(41046),t(83718),t(45718),t(71030),t(58032),t(16825),t(28572),t(1568),t(97127),t(63107),t(89528);var p=t(48069),v=t(40921),m=t(46978),h=t(21730),g=t(86998),b=t(35770),x=t(62082),y=(0,i.createContext)({theme:"light",model:"default"}),I=function(){var e=(0,i.useContext)(y);if(!e)throw Error("useAppTheme must be used within a useAppTheme");return e},_=function(e){var n=e.children,t=e.theme,i=e.model;return(0,r.jsx)(y.Provider,{value:{theme:void 0===t?"light":t,model:void 0===i?"default":i},children:n})},C=function(){var e=I(),n=(0,i.useCallback)(function(){return(0,r.jsx)(x.Z,{theme:"background"===e.model?"dark":"light"})},[e.model]),t=(0,b.DM)(n);return(0,i.useMemo)(function(){return{user:{placement:"end",variant:"outlined",typing:!0,className:"chat-message-bubble chat-message-bubble-user",classNames:{content:"chat-message-bubble-content chat-message-bubble-content-user"},loadingRender:t},ai:{placement:"start",variant:"outlined",className:"chat-message-bubble chat-message-bubble-ai",classNames:{content:"chat-message-bubble-content chat-message-bubble-content-ai",footer:"chat-message-bubble-footer"},loadingRender:t},error:{placement:"start",variant:"shadow"},suggestion:{placement:"start",variant:"borderless",className:"chat-message-bubble",loadingRender:t,typing:!0}}},[])},j=t(70124),w=function(e){var n=e.avatar,t=e.name,i=e.model,u=e.description,o=e.children;return(0,r.jsxs)("div",{className:"welcome-wrapper","data-model":i,children:["background"!==i&&(0,r.jsxs)("div",{className:"welcome-header",children:[(0,r.jsx)(j.qE,{className:"welcome-avatar",src:n}),t&&(0,r.jsxs)("label",{className:"welcome-title",children:["创建人 ",t]})]}),u&&(0,r.jsx)("article",{className:"welcome-description",children:u}),o]})},P=t(83964),S=t(44057),N=t(54038),M=t(41394),T=t(44474),Z=t(16113),k=i.memo(function(e){var n=e.className,t=e.messageId,u=e.uuid,o=e.content,s=e.status,a=e.isLastMessage,l=e.aiMessage,c=e.userMessage,d=e.onLongPress,f="success"===s,p=(0,i.useRef)(),v=(0,b.dz)({role:"ai",content:o,uuid:u,messageId:t,isReplyCompleted:f,isLastMessage:a,aiMessage:l,userMessage:c});(0,b.TA)(p,!f,function(){null==d||d(v)});var m=(0,i.useMemo)(function(){var e=o;return o&&"updating"===s&&(e+="{{end_dot}}"),e},[o,s]);return(0,r.jsx)("div",{ref:p,className:"-mx-12 -my-12 py-12 px-12 select-none",children:(0,r.jsx)(Z.Z,{content:m,className:n},t)})}),E=function(e){var n=e.onLongPress,t=(0,S._)(e,["onLongPress"]),u=(0,i.useRef)(),o=(0,a._)({role:"user"},t),s=(0,b.dz)(o);return(0,b.TA)(u,!1,function(){null==n||n(s)}),(0,r.jsx)("div",{ref:u,className:"flex flex-col items-end -m-12 px-12 py-12 break-all whitespace-normal select-none",children:(0,r.jsx)("article",{children:t.content})})},A=t(85841),L=function(e,n,t){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"up",u=(null!=(r=e[n])?r:{}).message;if(u&&u["up"===i?"uuid":"pid"]==t)return u},R=i.forwardRef(function(e,n){var t,u,o,s=e.loading,l=e.rootClassName,d=e.welcome,f=e.className,v=e.model,m=e.style,h=e.roles,g=e.items,x=void 0===g?[]:g,y=e.userMessageIds,I=e.isOpenAction,_=e.onTouchMove,C=e.onLongPress,w=i.useRef(null),P=(0,c._)((0,i.useState)(!1),2),Z=P[0],R=P[1],O=(0,i.useRef)(!1),D=(0,i.useCallback)(function(){var e;return null==(e=w.current)?void 0:e.nativeElement},[]),U=(0,b.Yv)(D,"vertical"),q=(0,b.P2)(function(){var e;return null==(e=w.current)?void 0:e.nativeElement}),F=q.getScrollPosition,B=q.scrollToBottom,J=q.scrollReachEnd,H=q.updateScrollReachEnd;(0,b.$d)(function(e){if(R(e.visible),e.visible&&J&&setTimeout(function(){return B()},100),!e.visible){H();var n=F();setTimeout(function(){var e;null==(e=w.current)||e.nativeElement.scrollTo(0,n)},100)}}),(0,i.useImperativeHandle)(n,function(){return{scrollToBottom:B}});var Y=(u=null==(t=w.current)?void 0:t.nativeElement,o=!1,u&&(U.direction?"down"===U.direction?o=!0:U.direction&&(o=u.scrollHeight-Math.abs(u.scrollTop)-u.clientHeight>70):o=O.current),O.current=o,o),z=(0,i.useMemo)(function(){var e,n=x.length,t=(null==(e=x[n-1])?void 0:e.message.role)==="suggestion",i=n-(t?2:1);return x.map(function(e,n){var t=e.id,u=e.message,o=e.status,s=(0,N.Z)(u,["isDeep","isMessageEmpty"]),l=s.status,c=s.msgId,d=s.uuid,f=(s.question,s.pid),v=s.ctxClearFlag,m=(0,S._)(s,["status","msgId","uuid","question","pid","ctxClearFlag"]),h=null!=c?c:y.get(d),g=i===n,b=(0,a._)({id:t,key:null!=h?h:t,loading:(null!=l?l:o)==="loading"},m),I=L(x,n-1,f,"up"),_=L(x,n+1,d,"down"),P=(null==_?void 0:_.status)==="success";switch(u.role){case"user":u.msgId=h,b.messageRender=function(e){return(0,r.jsx)(E,{content:e.question,uuid:d,messageId:h,isReplyCompleted:P,userMessage:u,aiMessage:_,onLongPress:C})},b.onTypingComplete=function(){var e,n,t=null==(e=w.current)?void 0:e.nativeElement;t&&(null==(n=w.current)||n.nativeElement.scrollTo({top:t.scrollHeight}))};break;case"ai":b.typing="success"!==o&&{step:2,interval:20},b.messageRender=function(e){return(0,r.jsx)(k,{userMessage:I,aiMessage:u,messageId:h,status:l,uuid:d,isLastMessage:g,content:e,onLongPress:C})},"success"===o&&v&&(b.footer=(0,r.jsx)(j.iz,{className:"message-divider",children:"聊聊新话题"}));break;case"suggestion":b.messageRender=function(e){return(0,r.jsx)(T.Z,{content:e})},b.onTypingComplete=function(){var e,n,t=null==(e=w.current)?void 0:e.nativeElement;t&&(0,p.AX)(t,200)&&(null==(n=w.current)||n.nativeElement.scrollTo({top:t.scrollHeight}))}}return b})},[x]);return(0,r.jsxs)("div",{className:(0,p.cx)("chat-messages-wrapper",l,{visible:Y||I}),style:m,"data-model":v,onTouchMove:_,children:[(0,r.jsx)(M.Z.List,{roles:h,ref:w,className:(0,p.cx)("chat-messages",f),items:z.length>0?z:[{content:d,className:"chat-message-bubble",classNames:{content:"w-full"},variant:"borderless"}]}),!J&&!Z&&(0,r.jsx)(A.Z,{loading:s,onClick:function(){return B()}})]})}),O=i.memo(R);t(75045);var D=t(69161),U=t(92890),q=t(34743),F=t(38415),B=t(72137);t(26644),t(32307),t(77137),t(52802),t(96445),t(47763);var J=t(26678);t(38851);var H=t(99222),Y=t(62484),z=t(31342),V=t(80046),$=t(84934),K="SENDER_INPUT_TYPE",W=(0,p.dl)();(0,i.forwardRef)(function(e,n){var t,u=e.onFoucs,o=e.suggestionMessage,d=e.onBlur,m=e.onCancel,h=e.loading,x=e.onSubmit,y=e.fileUploadOption,I=(0,S._)(e,["onFoucs","suggestionMessage","onBlur","onCancel","loading","onSubmit","fileUploadOption"]),_=(0,i.useRef)(null),C=(0,c._)((0,B.f6)({defaultState:"INPUT",key:K}),2),w=C[0],P=C[1],N=(0,c._)((0,$.p)(null==y?void 0:y.fileList),2),M=N[0],T=N[1],Z=(0,c._)((0,i.useState)(!1),2),k=Z[0],E=Z[1],A=(0,i.useMemo)(function(){return!!I.value.trim()},[I.value]),L=(0,i.useCallback)(function(e){var n;null==e||null==(n=e.stopPropagation)||n.call(e),null==m||m()},[m]);(0,i.useImperativeHandle)(n,function(){return(0,l._)((0,a._)({},_.current),{blur:function(){var e;return null==(e=_.current)?void 0:e.blur()},submit:x})});var R=(0,g.M)(),O=R.aiModel,X=R.chatModels,G=(0,i.useMemo)(function(){var e,n="给AI发消息",t=null==X||null==(e=X.modelList)?void 0:e.find(function(e){return e.value===O});return t&&(n=n.replace("AI",t.title)),n},[O,X]);(0,B.xI)(function(){null==u||u()}),(0,B.B9)(function(){null==d||d()});var Q=(0,i.useRef)(0);(0,i.useEffect)(function(){var e,n=function(){Q.current=Date.now()},t=null==_||null==(e=_.current)?void 0:e.nativeElement.querySelector(".ant-sender-input");return null==t||t.setAttribute("enterkeyhint","send"),null==t||t.setAttribute("inputmode","text"),null==t||t.addEventListener("blur",n),function(){null==t||t.removeEventListener("blur",n)}},[]);var ee=(0,b.DM)(function(e){if(h)return void j.FN.show({content:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{children:"生成中"}),(0,r.jsx)("div",{children:"请稍后发送或停止回答"})]}),position:"center"});var n,t,i=(null==M?void 0:M.length)===1&&(null==(n=M[0])?void 0:n.docId)==="-1",u=null==M?void 0:M.every(function(e){return e.status===Y.K.PARSE_SUCCESS});M&&(i||u)&&(null==(t=_.current)||t.blur(),L(),x(e,M),T([]))}),en=(0,c._)((0,i.useState)(!0),2),et=en[0],er=en[1];(0,i.useEffect)(function(){var e,n=null==_||null==(e=_.current)?void 0:e.nativeElement.querySelector(".ant-sender-input");null==n||n.setAttribute("enterkeyhint","send"),null==n||n.setAttribute("inputmode","text")},[]),(0,i.useEffect)(function(){if(M&&(null==M?void 0:M.length)!==0){var e;(null==M||null==(e=M[0])?void 0:e.docId)==="-1"?E(!0):E(null==M?void 0:M.every(function(e){return e.status===Y.K.PARSE_SUCCESS}))}else E(!0)},[M]),(0,i.useEffect)(function(){v.ZP.checkPermission("microphone").then(function(e){e||P("INPUT")})},[]);var ei=(0,b.DM)((t=(0,s._)(function(e){var n;return(0,f.Jh)(this,function(e){switch(e.label){case 0:return[4,v.ZP.checkPermission("microphone")];case 1:if(!e.sent())return[3,2];return P("AUDIO"),[3,4];case 2:return[4,(0,v.Wd)()];case 3:n="1"===e.sent().appType?"bluetoothConnect":null,v.ZP.requestPermission("microphone",n),e.label=4;case 4:return[2]}})}),function(e){return t.apply(this,arguments)})),eu=(0,b.DM)(function(){k&&ee(I.value)}),eo=(0,b.DM)(function(){return es({loading:h})}),es=function(e){var n,t=e.loading,u=[],o=(0,r.jsx)("div",{className:" w-[32px] h-[32px] flex items-center justify-center",onClick:eu,children:(0,r.jsx)("div",{className:(0,p.cx)("w-[22px] h-[22px] bg-primary text-white rounded-full  flex items-center justify-center",{"opacity-40":!k}),children:(0,r.jsx)(F.Z,{type:"icon-SendOutlined",className:"!text-[14px]"})})}),s=(0,r.jsx)(z.Z,{}),a=(0,r.jsx)("div",{className:"w-[32px] h-[32px] flex items-center justify-center",onClick:L,onMouseDown:function(e){return e.stopPropagation()},children:(0,r.jsx)(q.Z,{className:"w-[22px] h-[22px] text-primary "})}),l=(0,r.jsx)("div",{className:"w-[32px] h-[32px]  flex items-center justify-center",onMouseDown:function(e){return e.stopPropagation()},onClick:ei,children:(0,r.jsx)(F.Z,{type:"icon-VoiceinputOutlined",className:"!text-[24px]"})}),c=(0,r.jsx)("div",{className:"flex items-center  justify-center w-[32px] h-[32px]",onClick:function(){return P("INPUT")},children:(0,r.jsx)(F.Z,{type:"icon-keyboardOutlined",className:"!text-[24px] switch-input-icon"})});return(null==M?void 0:M.length)===0&&(null==I||null==(n=I.value)?void 0:n.trim())===""&&u.push(s),t?u.push(a):"INPUT"===w?A?u.push(o):u.push(l):u.push(c),(0,r.jsx)("div",{className:"flex space-x-8 items-center leading-0",children:u.map(function(e,n){return(0,r.jsx)(i.Fragment,{children:e},n)})})},ea=(0,b.DM)(function(e){return es({loading:"sending"===e||h})});(0,i.useEffect)(function(){T((null==y?void 0:y.fileList)||[])},[null==y?void 0:y.fileList]),(0,i.useEffect)(function(){var e;null==y||null==(e=y.onFileListChange)||e.call(y,M)},[M]);var el=(0,i.useMemo)(function(){try{if(!W)return y;var e=(0,c._)(W.split("."),1)[0];if(Number(e)>=12)return y;return y&&!!(null==M?void 0:M.length)}catch(e){return y}},[y,null==M?void 0:M.length]);return(0,r.jsxs)("div",{className:"chat-sender-wrapper pt-10 !pb-0 relative z-[10]",children:[void 0===o?null:o,(0,r.jsxs)("div",{className:(0,p.cx)("min-h-[48px] relative bg-white"),children:["AUDIO"===w&&(0,r.jsx)(U.l,{uploading:!k,onCancel:m,loading:h,className:(0,p.cx)("absolute left-0 bottom-0 w-full box-border z-1 rounded-full"),onSubmit:ee,actionNode:ea,onRecording:function(e){return er(!e)}}),(0,r.jsx)(D.Z,(0,l._)((0,a._)({header:el?(0,r.jsx)(D.Z.Header,{open:!!(null==M?void 0:M.length),title:null,closable:!1,className:(0,p.cx)("files-panel-wrapper",{"!border-transparent":!(null==M?void 0:M.length)}),children:(0,r.jsx)(Y.Z,{filesList:M,handleFilesList:function(e){T(e)},handleSelectSuggestionMessage:function(e){ee(e)}})}):null,components:{input:V.Z},ref:_,placeholder:G},I),{loading:h,className:(0,p.cx)(I.className,"mt-0 !text-14 rounded-24",{invisible:!w}),onSubmit:ee,autoSize:{minRows:1,maxRows:4},actions:eo}))]}),(0,r.jsx)(J.Z,{className:et?"visible":"invisible",onSearchTypeChange:function(){if(Date.now()-Q.current<200){var e;null==_||null==(e=_.current)||e.focus()}}}),(0,r.jsx)(H.c,{})]})}).displayName="ChatSender";var X=i.forwardRef(function(e,n){var t,u=e.rootClassName,o=e.loading,d=e.value,m=e.model,h=e.onCancel,g=(0,S._)(e,["rootClassName","loading","value","model","onCancel"]),x=(0,i.useRef)(null),y=(0,c._)((0,i.useState)(!1),2),I=y[0],_=y[1],C=(0,c._)((0,B.f6)({defaultState:"INPUT",key:K}),2),j=C[0],w=C[1],P=(0,i.useMemo)(function(){return!!(null==d?void 0:d.trim())},[d]);(0,b.$d)(function(e){_(e.visible)}),(0,i.useEffect)(function(){v.ZP.checkPermission("microphone").then(function(e){e||w("INPUT")})},[]);var N=(0,i.useCallback)((t=(0,s._)(function(e){var n;return(0,f.Jh)(this,function(t){switch(t.label){case 0:return e.stopPropagation(),[4,v.ZP.checkPermission("microphone")];case 1:if(!t.sent())return[3,2];return w("AUDIO"),[3,4];case 2:return[4,(0,v.Wd)()];case 3:n="1"===t.sent().appType?"bluetoothConnect":null,v.ZP.requestPermission("microphone",n),t.label=4;case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),[]);(0,i.useImperativeHandle)(n,function(){return(0,l._)((0,a._)({},x.current),{blur:function(){var e;return null==(e=x.current)?void 0:e.blur()},submit:g.onSubmit})}),(0,i.useEffect)(function(){var e,n=null==x||null==(e=x.current)?void 0:e.nativeElement.querySelector(".ant-sender-input");null==n||n.setAttribute("enterkeyhint","send"),null==n||n.setAttribute("inputmode","text")},[]);var M=(0,i.useCallback)(function(e){var n;null==e||null==(n=e.stopPropagation)||n.call(e),null==h||h()},[h]),T=(0,b.DM)(function(){var e,n;null==(e=x.current)||e.blur(),null==(n=g.onSubmit)||n.call(g,d,"INPUT")}),Z=(0,b.DM)(function(){return k({loading:o})}),k=function(e){var n=e.loading,t=[],i=(0,r.jsx)("div",{className:"w-[32px] h-[32px] flex items-center justify-center",onClick:T,children:(0,r.jsx)("div",{className:(0,p.cx)("w-[22px] h-[22px] bg-primary text-white rounded-full  flex items-center justify-center",{" opacity-40":!1}),children:(0,r.jsx)(F.Z,{type:"icon-SendOutlined",className:"!text-[14px]"})})},1),u=(0,r.jsx)("div",{className:" w-[32px] h-[32px] flex items-center justify-center",onClick:M,onMouseDown:function(e){return e.stopPropagation()},children:(0,r.jsx)(q.Z,{className:"w-[22px] h-[22px] text-primary "})},2),o=(0,r.jsx)("div",{className:"w-[32px] h-[32px] flex items-center justify-center",onMouseDown:function(e){return e.stopPropagation()},onClick:N,children:(0,r.jsx)(F.Z,{type:"icon-VoiceinputOutlined",className:"!text-[24px] switch-input-icon"})},3),s=(0,r.jsx)("div",{className:"flex items-center justify-center w-[32px] h-[32px]",onClick:function(){return w("INPUT")},children:(0,r.jsx)(F.Z,{type:"icon-keyboardOutlined",className:"!text-[24px] switch-input-icon"})},4);return n?t.push(u):"INPUT"===j?P?t.push(i):t.push(o):t.push(s),(0,r.jsx)("div",{className:"space-x-8 flex items-center leading-0",children:t})},E=(0,b.DM)(function(e){return k({loading:"sending"===e||o})});return(0,r.jsx)("div",{className:(0,p.cx)("chat-sender-wrapper relative !mx-0 !px-12 !pb-safe-bottom",u),"data-model":m,children:(0,r.jsxs)("div",{className:(0,p.cx)("min-h-[48px]"),children:["AUDIO"===j&&j&&(0,r.jsx)(U.l,{loading:o,onCancel:h,className:"chat-sender",onSubmit:function(e){h(),g.onSubmit(e,"AUDIO")},actionNode:E}),"INPUT"===j&&j&&(0,r.jsx)(D.Z,(0,l._)((0,a._)({ref:x,value:d,loading:o,className:(0,p.cx)("chat-sender"),classNames:{input:(0,p.cx)("chat-sender-input",{"input-focus":I})},components:{input:V.Z}},g),{onSubmit:function(e){var n,t;null==(n=x.current)||n.blur(),null==(t=g.onSubmit)||t.call(g,e,"INPUT")},actions:Z}))]})})});X.displayName="ChatSender";var G=i.memo(X),Q=t(7093),ee=t(87612),en=t(49932);t(60833),t(14438);var et=function(e){var n=e.reverse();return n.map(function(e,t){var r=e.role,i=e.msgId,u=e.question,o=e.ext,s=e.content,a=e.chatId,l={role:"user"===r?"user":"ai",msgId:i,uuid:(0,h.x0)(6),typing:!1,question:u,isDeep:null==o?void 0:o.isDeep,content:null!=s?s:"",status:"success"};if("user"===r&&(l.content={question:null!=s?s:""},l.uuid=a),"assistant"===r&&(l.content=[{role:"ai",content:null!=s?s:"",msgId:i,pid:a,uuid:(0,h.x0)(6),question:u,isDeep:null==o?void 0:o.isDeep,status:"success",ctxClearFlag:o.ctxClearFlag}],(null==o?void 0:o.followUp)&&t===n.length-1)){var c=JSON.parse(o.followUp);c.length&&l.content.push({role:"suggestion",content:c,uuid:(0,h.x0)(6)})}return{id:e.msgId,message:l,status:"success"}})},er=function(e,n){var t,r=(0,i.useRef)(function(){}),u=(0,i.useRef)(void 0),o=(0,c._)((0,i.useState)({loading:!1}),2),a=o[0],l=o[1],d=(0,i.useCallback)((t=(0,s._)(function(e){var t,i,u,o,s,a,c,d,p,v;return(0,f.Jh)(this,function(f){switch(f.label){case 0:return f.trys.push([0,4,,5]),l({loading:!0}),u=new AbortController,o={},r.current=function(){u.abort()},[4,(0,en.Hr)({body:{agentId:e},signal:u.signal})];case 1:if((s=f.sent().data).success&&(o.agentInfo=s.data),!(null==o||null==(t=o.agentInfo)?void 0:t.conversationId))return[3,3];return c=null==(a=o.agentInfo)?void 0:a.conversationId,d=new AbortController,r.current=function(){d.abort()},[4,(0,en.uo)({body:{conversationId:c,agentId:e,order:"desc",limit:40},signal:d.signal})];case 2:v=et(null!=(p=f.sent().data.data.msgList)?p:[]),o.msgList=v,f.label=3;case 3:return null==n||n(o),setTimeout(function(){l({loading:!1,data:o})},10*(null==(i=o.msgList)||!i.length)),[3,5];case 4:return f.sent(),l({loading:!1}),[3,5];case 5:return[2]}})}),function(e){return t.apply(this,arguments)}),[]);return(0,i.useEffect)(function(){return u.current=setTimeout(function(){e&&d(e)},0),function(){clearTimeout(u.current),r.current()}},[e]),a},ei=t(83116),eu=i.forwardRef(function(e,n){var t,u,o,x=e.initialLoading,y=e.initialData,_=(0,g.M)(),S=(0,i.useRef)(null),N=(0,i.useRef)(),M=(null!=y?y:{}).agentInfo,Z=(0,c._)((0,i.useState)(!1),2),k=Z[0],E=Z[1],A=(0,i.useRef)(),L=(0,b.lq)(),R=L.switchSpeech,D=L.stopSpeech,U=(0,c._)((0,i.useState)(!1),2),q=U[0],F=U[1],J=(0,c._)((0,i.useState)([]),2),H=J[0],Y=J[1],z=(0,i.useRef)(),V=(0,i.useRef)(),$=(0,i.useRef)(),K=(0,i.useRef)(),W=(0,c._)(i.useState(""),2),X=W[0],et=W[1],er=I(),eu=C(),eo=(0,i.useRef)(!1),es=(0,b.VP)(),ea=(0,b.yG)(v.ZP.getWsId),el=(0,i.useRef)({stream:!0,agentId:null==M?void 0:M.agentId}),ec=(0,i.useMemo)(function(){var e;return(null!=(e=null==M?void 0:M.followUp)?e:[]).map(function(e){return e.value})},[null==M?void 0:M.followUp]),ed=(0,i.useCallback)((0,s._)(function(){var e,n,t,r,i,u;return(0,f.Jh)(this,function(o){switch(o.label){case 0:return e={},[4,v.ZP.getTtsState()];case 1:if(n=o.sent(),v.ZP.onInterruptTts(),e.chatOption={autoTts:!!n},!n)return[3,3];return[4,ea.startPolling()];case 2:t=o.sent(),e.chatOption.wsId=t,o.label=3;case 3:if(el.current.conversationId)return[3,5];return[4,(0,en.EL)({body:{agentId:el.current.agentId}})];case 4:u=null==(i=o.sent().data)||null==(r=i.data)?void 0:r.conversationId,el.current=(0,l._)((0,a._)({},el.current),{conversationId:u}),v.ZP.onConversationId({conversationId:u}),e.conversationId=u,o.label=5;case 5:return[2,e]}})}),[]),ef=(0,i.useCallback)(function(e){if(eo.current){var n;eo.current=!1,(0,m.Z)((n=(0,s._)(function(n){var t,r,i;return(0,f.Jh)(this,function(u){switch(u.label){case 0:return[4,(0,en.Y7)({body:{}})];case 1:return(null==(i=(void 0===(r=(void 0===(t=u.sent().data)?{}:t).data)?[]:r).find(function(n){return n.conversationId===e}))?void 0:i.title)&&(null==i?void 0:i.title)!=="新会话"&&(n(),v.ZP.onTitle({title:i.title,conversationId:e})),[2]}})}),function(e){return n.apply(this,arguments)}),{maxAttempts:10,interval:15e3})}},[]),ep=(0,b.nO)(el.current,{beforeSubmit:ed,onChatCompleted:ef}),ev=ep.loading,em=ep.onChatSubmit,eh=ep.questionIdsMap,eg=ep.parsedMessages,eb=ep.setMessages,ex=ep.onCancelReply,ey=ep.onRemoveChatHistory,eI=(0,i.useCallback)((t=(0,s._)(function(e){var n,t;return(0,f.Jh)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),0===eg.length)return j.FN.show({content:(0,r.jsx)("span",{className:"text-[14px]",children:"暂无上下文"}),duration:1e3}),[2];return v.ZP.showLoading({message:"正在清除上下文"}),[4,(0,en.hC)({body:{agentId:null==e?void 0:e.agentId}})];case 1:return(null==(n=i.sent().data)?void 0:n.success)&&(eb(function(e){var n=e[e.length-1];if("ai"===n.message.role){var t=n.message.content[0];t&&(t.ctxClearFlag=!0)}return(0,d._)(e)}),clearTimeout(z.current),z.current=setTimeout(function(){return N.current.scrollToBottom()},100)),v.ZP.hideLoading(),[3,3];case 2:throw t=i.sent(),v.ZP.hideLoading(),Error(t.message);case 3:return[2]}})}),function(e){return t.apply(this,arguments)}),[eg]);(0,B.Uj)(eI);var e_=(0,i.useCallback)((u=(0,s._)(function(e,n){var t;return(0,f.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),v.ZP.showLoading({message:"删除中..."}),[4,(0,en.EC)({body:{msgId:e}})];case 1:if(!r.sent().data.success)return[3,3];return[4,v.ZP.getTtsPlayStatus()];case 2:(null==(t=r.sent())?void 0:t.isPlaying)&&t.msgId===e&&D(),ey(n),r.label=3;case 3:return v.ZP.hideLoading(),[3,5];case 4:return r.sent(),v.ZP.hideLoading(),[3,5];case 5:return[2]}})}),function(e,n){return u.apply(this,arguments)}),[]),eC=(0,i.useCallback)(function(e){D(),ex(),em({role:"user",content:{conversationId:el.current.conversationId,agentId:el.current.agentId,question:e},uuid:(0,h.x0)(6),status:"local"}),et("")},[]),ej=(0,i.useCallback)(function(){V.current.blur()},[]),ew=(0,i.useCallback)(function(e){clearTimeout($.current);var n,t=(n=(0,s._)(function(){var n,i,u,o;return(0,f.Jh)(this,function(s){switch(s.label){case 0:if((n=e()).isReplyCompleted||($.current=setTimeout(t,1e3)),i=[{text:(0,r.jsx)(ee.Z.Item,{icon:"icon-CopyOutlined",text:"复制"}),key:"copy"},{text:(0,r.jsx)(ee.Z.Item,{icon:"icon-ShareOutlined",text:"分享"}),key:"share",disabled:!n.isReplyCompleted},{text:(0,r.jsx)(ee.Z.Item,{className:"text-[#FF4343]",icon:"icon-DeleteOutlined",text:"删除"}),key:"delete",disabled:!n.messageId||!n.uuid}],"ai"!==n.role||(n.isLastMessage&&i.unshift({text:(0,r.jsx)(ee.Z.Item,{icon:"icon-SyncOutlined",text:"重新生成"}),key:"again",disabled:!n.isReplyCompleted}),!(!n.aiMessage.isMessageEmpty&&(null==M?void 0:M.voiceType))))return[3,2];return[4,v.ZP.getTtsPlayStatus()];case 1:o=(null==(u=s.sent())?void 0:u.isPlaying)&&u.msgId===n.messageId?"PlayingOutlined":"PlayOutlined",i.unshift({text:(0,r.jsx)(ee.Z.Item,{icon:"icon-".concat(o),text:"语音播报"}),key:"speech"}),s.label=2;case 2:return K.current=n,Y(i),[2]}})}),function(){return n.apply(this,arguments)});t(),v.ZP.notifyDialog(!0),F(!0)},[null==M?void 0:M.voiceType]),eP=(0,i.useCallback)(function(){clearTimeout($.current),F(!1),Y([])},[]);(0,B.YQ)(eP);var eS=(0,b.DM)(eC);(0,i.useImperativeHandle)(n,function(){return{setInitialState:function(e){el.current=(0,a._)({},el.current,e)},setInitialMessages:function(e){eb(e)}}});var eN=(0,i.useCallback)((o=(0,s._)(function(e,n){var t,r,i;return(0,f.Jh)(this,function(u){switch(u.label){case 0:return i=null==_||null==(r=_.deviceInfo)||null==(t=r.params)?void 0:t.name,[4,(0,ei.qx)({questionItem:e,data:n,title:i,value:1,conversationId:el.current.conversationId})];case 1:return u.sent(),[2]}})}),function(e,n){return o.apply(this,arguments)}),[_]);return(0,i.useEffect)(function(){return M&&(M.appBgColorTone&&S.current.style.setProperty("--entity-bottom-shade-color",M.appBgColorTone),A.current=setTimeout(function(){E(!0)},10)),function(){clearTimeout(A.current),ea.stopPolling()}},[M]),(0,i.useEffect)(function(){v.ZP.onNotifyAnswerState(ev)},[ev]),(0,r.jsxs)(P.Z,{ref:S,model:null==er?void 0:er.model,className:"page-container bg-no-repeat !pb-0 !px-0",style:{paddingTop:"calc(".concat(null==_?void 0:_.deviceHeadHeight,"px)")},children:[(0,r.jsx)(Q.Z,{loading:x,description:"light"===er.theme?"加载中 请稍后...":void 0,theme:er.theme,children:(0,r.jsx)(O,{isOpenAction:q,ref:N,loading:ev,model:er.model,roles:eu,items:eg,userMessageIds:eh.current,rootClassName:"entity-chat-list",className:"entity-chat-list-body flex-auto max-h-full py-8 box-border scrollbar-hidden px-12",onTouchMove:ej,welcome:k&&(0,r.jsx)(w,{model:er.model,avatar:null==M?void 0:M.iconUrl,name:null==M?void 0:M.createShowPerson,description:null==M?void 0:M.description,children:!!ec.length&&(0,r.jsx)(T.Z,{content:ec,itemClassName:(0,p.cx)({"!bg-black/50":(null==er?void 0:er.model)==="background","!text-white/90":(null==er?void 0:er.model)==="background"}),onSelected:eC})}),onLongPress:ew})}),(0,r.jsx)(G,{ref:V,model:null==er?void 0:er.model,loading:ev,value:X,placeholder:"给我发消息",onChange:et,onCancel:function(){D(),ex()},onSubmit:eC}),(0,r.jsx)(ee.Z,{destroyOnClose:!0,visible:q,actions:H,onClose:eP,onAction:function(e){if("copy"===e.key)es(null==(n=K.current)?void 0:n.content,!0,function(){j.FN.show({icon:"success",content:"复制成功"})});else if("delete"===e.key)e_(null==(t=K.current)?void 0:t.messageId,null==(r=K.current)?void 0:r.uuid);else if("share"===e.key)eN(null==(i=K.current)?void 0:i.userMessage,null==(u=K.current)?void 0:u.aiMessage);else if("again"===e.key)eS(null==(o=K.current)?void 0:o.aiMessage.question);else if("speech"===e.key){var n,t,r,i,u,o,s=K.current.aiMessage;R({conversationId:el.current.conversationId,msgId:s.msgId,agent:!0})}eP()},afterClose:function(){v.ZP.notifyDialog(!1)}})]})}),eo=function(){var e=(0,g.M)(),n=(0,i.useRef)(),t=(0,i.useMemo)(function(){var n;return null!=(n=null==e?void 0:e.deviceInfo.params)?n:{}},[e.deviceInfo]),u=t.hasAppBgUrl||!!t.appBgUrl,o=(0,i.useCallback)(function(e){var t,r,i,u,o;null==(r=n.current)||r.setInitialState({agentId:null==(t=e.agentInfo)?void 0:t.agentId,conversationId:e.agentInfo.conversationId}),(null==e||null==(i=e.msgList)?void 0:i.length)&&(null==(u=n.current)||u.setInitialMessages(null!=(o=null==e?void 0:e.msgList)?o:[]))},[]),s=er(null==t?void 0:t.agentId,o),a=s.loading,l=s.data;return(0,r.jsx)(_,{theme:u?"dark":"light",model:u?"background":"default",children:(0,r.jsx)(eu,{ref:n,initialLoading:a,initialData:l})})};(0,u.createRoot)(document.getElementById("root")).render((0,r.jsx)(i.StrictMode,{children:(0,r.jsx)(function(){return(0,r.jsx)(o.Z,{isHasBar:!1,children:(0,r.jsx)(eo,{})})},{})}))},49932:function(e,n,t){t.d(n,{hC:function(){return b},EC:function(){return I},Y7:function(){return p},ZT:function(){return m},_R:function(){return f},mz:function(){return x},DK:function(){return d},Sd:function(){return l},Hr:function(){return h},De:function(){return s},fJ:function(){return a},EL:function(){return g},Px:function(){return v},VZ:function(){return y},uo:function(){return c}});var r=t(779),i=t(82616),u=t(37443),o=t(66657),s=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({url:"/app/shareApi/v1/getShareId"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},a=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({url:"/app/shareApi/v1/createOrUpdate"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},l=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({url:"/app/messageApi/v1/tts"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},c=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({responseTransformer:u.OT,url:"/app/messageApi/v1/list"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},d=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({responseTransformer:u.jE,url:"/app/knowledgeApi/v1/infos"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},f=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({url:"/app/conversationApi/v1/updateChatModelConfig"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},p=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({url:"/app/conversationApi/v1/list"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},v=function(e){var n;return(null!=(n=null==e?void 0:e.client)?n:o.L).post((0,r._)({url:"/app/configApi/v1/getDocSuggestQuestion"},e))},m=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({responseTransformer:u.JG,url:"/app/attachmentApi/v1/infos"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},h=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({url:"/app/agentApi/v1/detail"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},g=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({url:"/app/agentApi/v1/create"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},b=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({url:"/app/agentApi/v1/clearContext"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},x=function(e){var n;return(null!=(n=e.client)?n:o.L).post((0,i._)((0,r._)({url:"/app/agentApi/v1/agentChat"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))},y=function(e){var n;return(null!=(n=null==e?void 0:e.client)?n:o.L).get((0,r._)({url:"/app/configApi/v1/config"},e))},I=function(e){var n;return(null!=(n=e.client)?n:o.L).delete((0,i._)((0,r._)({url:"/app/messageApi/v1/delete"},e),{headers:(0,r._)({"Content-Type":"application/json"},null==e?void 0:e.headers)}))}},48069:function(e,n,t){t.d(n,{A5:function(){return h},AX:function(){return d},Ab:function(){return a},CJ:function(){return g},Vx:function(){return c},Xp:function(){return f},Zw:function(){return s.Z},_v:function(){return p},cw:function(){return v},cx:function(){return o.cx},dK:function(){return m},dl:function(){return b},mZ:function(){return l}});var r=t(32091);t(97127),t(31261),t(71227),t(13023),t(96692),t(24679),t(46575),t(81273),t(58032),t(59295),t(14438),t(73135),t(63107),t(89528),t(54263),t(16825),t(60833),t(73886),t(32307),t(28213),t(26644),t(44411),t(47763),t(96445),t(61211),t(30955);var i=t(73614),u=t.n(i),o=t(56944),s=t(65430);t(62371);var a=function(e,n){if("GET"===e.method)return n.query?"".concat(new URLSearchParams(n.query).toString()):"";if("POST"===e.method){var t;return null!=(t=n.body)?t:""}return""},l=function(e,n,t){return u()("".concat(e).concat(n).concat(t)).toUpperCase()},c=function(e){try{return JSON.parse(e),!0}catch(e){return!1}},d=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,t=e.scrollTop+e.clientHeight;return e.scrollHeight-t<=n},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.max(Math.floor(e/window.devicePixelRatio),0)};function p(e){return new Promise(function(n){return setTimeout(n,e)})}function v(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/^#+\s/gm,"")).replace(/\*\*(.*?)\*\*/g,"$1")).replace(/\*(.*?)\*/g,"$1")).replace(/\[(.*?)\]\((.*?)\)/g,"$1")).replace(/^>\s/gm,"")).replace(/^-\s/gm,"")).replace(/^\d+\.\s/gm,"")).replace(/```[\s\S]*?```/g,"")).replace(/`(.*?)`/g,"$1")}function m(e,n){return(void 0===n?"undefined":(0,r._)(n))==="bigint"?n.toString()+"n":n}var h=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,t=e;switch(void 0===e?"undefined":(0,r._)(e)){case"string":t=BigInt(e.slice(0,-1));break;case"number":t=BigInt(e);break;default:t=e}var i=BigInt(1024)*BigInt(1024),u=BigInt(1024),o=t/i,s=t%i;if(o>BigInt(0)){var a=(Number(s)/Number(i)).toFixed(n);return"".concat(o,".").concat(a.split(".")[1],"MB")}var l=t/u,c=t%u;if(l>BigInt(0)){var d=(Number(c)/Number(u)).toFixed(n);return"".concat(l,".").concat(d.split(".")[1],"KB")}return"".concat(t,"B")},g=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,t=e;switch(void 0===e?"undefined":(0,r._)(e)){case"string":t=BigInt(e.slice(0,-1));break;case"number":t=BigInt(e);break;default:t=e}var i=BigInt(1e4);if(t<i)return"".concat(t,"字");var u=t/i,o=Number(t%i)/1e4,s="".concat(u);if(o>0){var a=o.toFixed(n).split(".")[1];s+=".".concat(a)}return"".concat(s,"万字")};function b(){var e=navigator.userAgent;if(e.indexOf("Android")>=0){var n=e.match(/Android\s([0-9\.]+)/i);if(n&&n[1])return n[1]}return null}}},s={};function a(e){var n=s[e];if(void 0!==n)return n.exports;var t=s[e]={id:e,loaded:!1,exports:{}};return o[e].call(t.exports,t,t.exports,a),t.loaded=!0,t.exports}a.m=o,a.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(n,{a:n}),n},n=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},a.t=function(t,r){if(1&r&&(t=this(t)),8&r||"object"==typeof t&&t&&(4&r&&t.__esModule||16&r&&"function"==typeof t.then))return t;var i=Object.create(null);a.r(i);var u={};e=e||[null,n({}),n([]),n(n)];for(var o=2&r&&t;"object"==typeof o&&!~e.indexOf(o);o=n(o))Object.getOwnPropertyNames(o).forEach(function(e){u[e]=function(){return t[e]}});return u.default=function(){return t},a.d(i,u),i},a.d=function(e,n){for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t=[],a.O=function(e,n,r,i){if(n){i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[n,r,i];return}for(var o=1/0,u=0;u<t.length;u++){for(var n=t[u][0],r=t[u][1],i=t[u][2],s=!0,l=0;l<n.length;l++)(!1&i||o>=i)&&Object.keys(a.O).every(function(e){return a.O[e](n[l])})?n.splice(l--,1):(s=!1,i<o&&(o=i));if(s){t.splice(u--,1);var c=r();void 0!==c&&(e=c)}}return e},a.rv=function(){return"1.3.9"},a.j="146",r={146:0},a.O.j=function(e){return 0===r[e]},i=function(e,n){var t,i,u=n[0],o=n[1],s=n[2],l=0;if(u.some(function(e){return 0!==r[e]})){for(t in o)a.o(o,t)&&(a.m[t]=o[t]);if(s)var c=s(a)}for(e&&e(n);l<u.length;l++)i=u[l],a.o(r,i)&&r[i]&&r[i][0](),r[i]=0;return a.O(c)},(u=self.webpackChunkmobile_dangbei_ai=self.webpackChunkmobile_dangbei_ai||[]).forEach(i.bind(null,0)),u.push=i.bind(null,u.push.bind(u)),a.ruid="bundler=rspack@1.3.9";var l=a.O(void 0,["444","126","361","134","695","998","794","771"],function(){return a(27343)});a.O(l)}();