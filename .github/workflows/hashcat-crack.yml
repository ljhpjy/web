name: WiFi Handshake Crack

on:
  workflow_dispatch:
  push:
    paths:
      - 'hs/**'
      - '.github/workflows/hashcat-crack.yml'

jobs:
  crack-wifi:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y p7zip-full hashcat

      - name: Download WeakPass dictionary
        run: |
          echo "üì• Downloading WeakPass dictionary..."
          wget -q --show-progress https://download.weakpass.com/wordlists/2025/weakpass_4.merged.txt.7z -O weakpass_4.merged.txt.7z
          echo "‚úÖ Download completed"

      - name: Extract dictionary
        run: |
          echo "üì¶ Extracting dictionary..."
          7z x weakpass_4.merged.txt.7z -o. -y
          echo "‚úÖ Extraction completed"
          ls -lh weakpass_4.merged.txt

      - name: Crack WiFi handshake - wifi-01.cap
        id: crack1
        continue-on-error: true
        run: |
          echo "üîì Starting crack for wifi-01.cap..."
          hashcat -m 22000 -a 0 -w 3 --status --status-timer=10 hs/wifi-01.cap weakpass_4.merged.txt
          echo "crack1_status=completed" >> $GITHUB_OUTPUT

      - name: Crack WiFi handshake - wifi-02.cap
        id: crack2
        continue-on-error: true
        run: |
          echo "üîì Starting crack for wifi-02.cap..."
          hashcat -m 22000 -a 0 -w 3 --status --status-timer=10 hs/wifi-02.cap weakpass_4.merged.txt
          echo "crack2_status=completed" >> $GITHUB_OUTPUT

      - name: Show results
        if: always()
        run: |
          echo "üìä ===== CRACKING RESULTS ====="
          echo ""
          echo "--- WiFi-01 Results ---"
          hashcat -m 22000 hs/wifi-01.cap weakpass_4.merged.txt --show 2>/dev/null || echo "‚ùå No results for wifi-01.cap"
          echo ""
          echo "--- WiFi-02 Results ---"
          hashcat -m 22000 hs/wifi-02.cap weakpass_4.merged.txt --show 2>/dev/null || echo "‚ùå No results for wifi-02.cap"

      - name: Summary
        if: always()
        run: |
          echo "‚ú® Cracking process finished"
          echo "Task status - WiFi-01: ${{ steps.crack1.outcome }}"
          echo "Task status - WiFi-02: ${{ steps.crack2.outcome }}"
